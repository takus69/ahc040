# AHC040

## 日記

### 20241130

- 至高のアルゴリズムに参加していて初日は考察できず。二日目からスタート！
- グッズを順に箱に詰めて、そのサイズの最小化が目的
- 入れないグッズがあってもよいが、それは個別でサイズが計算される。変な隙間ができて、他の箱の邪魔にしかならない特殊なケース以外は、箱に入れる方がよいと考えられる。そのため入れないパターンは考えなくてもよいかも？ => 1個だけポツンと1行全て隙間ができるパターンを考える。その場合でも外に出すとhiが加算されるスコアになるので、すべて入れた方がスコアは良くなるはず。つまり邪魔なら一番邪魔にならない端っこ辺りにおけばいい？
- グッズのサイズ、入れ終わった箱のサイズは目分量しかないため、グッズのサイズを推測しながら最適な入れ方を探す
- 目分量のため報告の箱のサイズが大きくても実はスコアはいいというのがあり得る
- グッズのサイズが明確になっていると最適解が求められるのか？ => 多分ノー
  - 自由度は、箱の数(N)、入れるか入れないか(2)、回転するかしないか(2)、上左どちらに合わせるか(2)、どの箱に合わせるか(それまでに入れた数。最大Nで合計N*(N+1)/2) = 4*N^2*(N+1)かな？ => 上記で全部入れた方が良いとなれば自由度が下がり、全探索する回数は、2*N^2*(n+1) => 違った。8^N以上かかる。。。
  - Nは30～100だから、O(N^3)だと最大10^6 => サイズがわかっていれば、全探索できる？ => 上記のためできない
- 誤差を関係なく、全探索で最適解と思われるものを提出する？誤差が積みあがるので、結構な差が出ると思うが、初期解としてはいいかも
- 推測はベイズの定理を使うのかな。研究として最尤推定との違いも見てみたい
- TがN/2～4N = 15～400だから、すべて全探索していると時間が足りない。ランダムで提出してグッズのサイズを推測して、それをもとに最適解を提出という感じ？

- 全探索しようと思ったらスコア計算難しくない？？？
  - 正確なグッズのサイズがわかればスコア計算もできるが、ちょいずれで思ったように置けてなければ、かなりスコアの推測値が違ってくることになる
    - 各グッズを入れたら、その座標は分かる
    - 合わせるグッズを決めると、xやyは決まる。もう片方が他の箱も含めて最大の位置になる。各頂点に関する最大値をもっておく、そして自分の範囲内の最大値を探索すれば、置ける最大値がわかる(セグ木？)
- 最適解求めようとしても目分量だから、少し小さめになっていたら、目分量で合わせたら大きくずれるってことがあるのか。。。ちょいずれでひっかかって縦横に空間できるような置き方になりそう。それは箱に入れないのと同じぐらいのスコアになってしまうが、重なった部分が少し効率的になるので入れないよりはましになるはず => サイズ指定して入れるのではなく、どのグッズに合わせて入れてみてという形なので、少しずれて入らないというのは、あまりない。ただ他のグッズの位置が少しずれるので、邪魔にならないと思っていたのに邪魔でちゃんと入らなかったというのはありそう

- 全探索可能と勘違いしていたので、考え直し。。。
- とりあえず決めたときに、スコア計算(推測)ができるようにする。ベイズ推定と入れ方の最適化を考えるか

- occupancyは充填率。箱の面積に対して、グッズの面積の和の率。無駄がどの程度あるかがわかるが、この値が100%に近くても箱の縦横の使い方が良くなければスコアは悪くなる

- 縦に並べるだけの実装 => 正方形になるように並べる
  - 縦に並べる時に下から上じゃなく、右から左に置くと途中にひっかかることがなく、縦に順番通りに接する形で置けるので、無駄が少なくなる
- 実際の値に合わせたスコア計算ができてないため、実装が必要
- 改善のネタは以下
  - 回転などで変更して山登り
  - ビームサーチ

##　クラス設計

- Boxクラス
  - goodses: [(w, h)]
  - goods_statuses: [(x1, y1, x2, y2)]
  - score: int
  - instructions: [(r, d, b)]
  - add(goods, status)

## history

- v0: 縦に並べる(提出: 218,618,671)
- v1: 正方形になるように縦に並べる(提出: 62,175,618)

## 実行コマンド

- 1テストケース実行

```
cargo build
cat .\in\0000.txt | .\target\debug\ahc040.exe > .\out\0000.txt
```

- 一括実行

```
cargo build
python .\simulator.py
